define("Pool",["exports"],function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,i){Object.defineProperty(e,t,{writable:!1,configurable:!1,value:i})}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),n=function(){function e(o){var n=arguments.length<=1||void 0===arguments[1]?-1:arguments[1],r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],s=r.clearMethodName,l=void 0===s?null:s,a=r.destroyMethodName,h=void 0===a?null:a,u=r.isFactory,c=void 0===u?!1:u;t(this,e),this.size=n,i(this,"ObjectConstructor",o),i(this,"objectClearMethodName",l),i(this,"objectDestroyMethodName",h),i(this,"objectConstructorIsFactory",c),i(this,"borrowedObjects",[]),i(this,"availableObjects",[])}return o(e,[{key:"destroy",value:function(){this._destroyChildren(this.borrowedObjects),this._destroyChildren(this.availableObjects)}},{key:"_destroyChildren",value:function(e){var t=this.objectDestroyMethodName||this.objectClearMethodName;if(!t)return void e.splice(0,e.length);for(var i=void 0;i=e.pop();)try{i[t].call(i)}catch(o){if("undefined"==typeof console)throw o;console.log("Error during destroy")}}},{key:"borrows",value:function(){var e=null;return this.hasAvailables()&&(e=0===this.availableObjects.length?this.objectConstructorIsFactory?this.ObjectConstructor():new this.ObjectConstructor:this.availableObjects.pop(),this.borrowedObjects.push(e)),e}},{key:"returns",value:function(e){if(!(e instanceof this.ObjectConstructor))throw new Error("Can't return object which is not a "+this.ObjectConstructor.name);var t=this.borrowedObjects.indexOf(e);if(-1===t){if(this.availableObjects.includes(e))throw new Error(this.ObjectConstructor.name+" already returned !");throw new Error("Object given in Pool#returns() is not referenced in this Pool instance.")}if(this.borrowedObjects.splice(t,1),null!==this.objectClearMethodName)try{e[this.objectClearMethodName].call(e)}catch(i){if("undefined"==typeof console)throw i;console.log("Unable to call method "+this.objectClearMethodName+" on object instance "+String(e))}this.availableObjects.push(e)}},{key:"hasAvailables",value:function(){return-1===this.size||this.borrowedObjects.length<this.size}},{key:"getCountAvailables",value:function(){return this.availableObjects.length}},{key:"getCountBorrowed",value:function(){return this.borrowedObjects.length}},{key:"toString",value:function(){return"Pool<"+this.ObjectConstructor.name+">(borrowed: "+this.getCountBorrowed()+", available: "+this.getCountAvailables()+")"}}]),e}();e["default"]=n}),define("BufferedListItemView",["exports","jquery"],function(e,t){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=i(t),r=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),s=function(){function e(){o(this,e),this.$el=(0,n["default"])(this.el=document.createElement("li")),this.$el.addClass("item-view"),this.$=this.$el.find.bind(this.$el),this.el.__view__=this}return r(e,[{key:"destroy",value:function(){this.$el&&this.remove(),this.el&&delete this.el.__view__,delete this.model,delete this.$,delete this.$el,delete this.el}},{key:"clear",value:function(){this.remove(),this.el.innerHTML="",this.model=null}},{key:"remove",value:function(){this.$el.remove()}},{key:"template",value:function(){return String(this.indexInModelList)}},{key:"render",value:function(){this.$el.html(this.template())}}]),e}();e["default"]=s,s.CLEAR_METHOD="clear",s.DESTROY_METHOD="destroy"}),define("BufferedListView",["exports","jquery","backbone","Pool","BufferedListItemView"],function(e,t,i,o,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var h=r(t),u=r(i),c=r(o),d=r(n),f=function(){function e(e,t){var i=[],o=!0,n=!1,r=void 0;try{for(var s,l=e[Symbol.iterator]();!(o=(s=l.next()).done)&&(i.push(s.value),!t||i.length!==t);o=!0);}catch(a){n=!0,r=a}finally{try{!o&&l["return"]&&l["return"]()}finally{if(n)throw r}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),v=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),b=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];s(this,t);var i=l(this,Object.getPrototypeOf(t).call(this,e));i.el.__view__=i,i.isRendered=!1,i.listContainerSelector=e.listContainerSelector||".list-container:first > .list-display",i.scrollerContainerSelector=e.scrollerContainerSelector||".list-container:first",i.scrollPositionY=0,i.listHeight=e.listHeight||"auto",i.listHeightAutoMode="auto"===i.listHeight,i.listItemHeight=e.listItemHeight,i.idModelPropertyName=e.idModelPropertyName||"id",i.visibleOutboundItemsCount="number"!=typeof e.visibleOutboundItemsCount?2:e.visibleOutboundItemsCount,i.models=e.models||[];var o=e.ItemConstructor||i.getItemConstructor();return i.viewsPool=new c["default"](o,e.maxPoolSize||-1,{clearMethodName:o.CLEAR_METHOD,destroyMethodName:o.DESTROY_METHOD}),i.viewsMap=new Map,i._onWindowResize=i.onResize.bind(i),(0,h["default"])(window).on("resize",i._onWindowResize),i.listHeightAutoMode&&i.once("attach",function(){this.listHeight=this.queryListHeight(),this.isRendered&&(this.updateListScrollerHeight(),this.renderVisibleItems())}),i}return a(t,e),v(t,[{key:"isAttached",get:function(){return this.el&&this.el.parentNode}}]),v(t,[{key:"destroy",value:function(){(0,h["default"])(window).off("resize",this._onWindowResize),this.viewsPool.destroy(),this.el&&delete this.el.__view__,this.$el&&this.remove(),delete this._onWindowResize,delete this.models,delete this.el,delete this.$el}},{key:"getItemConstructor",value:function(){return d["default"]}},{key:"template",value:function(){return'<div class="list-container"><div class="list-content"></div><ol class="list-display"></ol></div>'}},{key:"render",value:function(){this.$el.html(this.template()),this.isRendered=!0,this.$listContainer=this.$(this.listContainerSelector),this.$scrollerContainer=this.$(this.scrollerContainerSelector),this.$scrollerContainer.on("scroll",this.onScroll.bind(this)),this.isAttached&&(this.updateListScrollerHeight(),this.renderVisibleItems())}},{key:"scrollToIndex",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=e*this.listItemHeight;t.animate?this.$scrollerContainer.animate({scrollTop:i},t.duration||300):this.$scrollerContainer.scrollTop(i)}},{key:"queryListHeight",value:function(){return this.$el.outerHeight()}},{key:"updateListScrollerHeight",value:function(){this.$scrollerContainer.find(".list-content").height(this.models.length*this.listItemHeight)}},{key:"defineRangeOfModelsVisibles",value:function(){var e=Math.floor(this.scrollPositionY/this.listItemHeight),t=Math.ceil(this.listHeight/this.listItemHeight),i=Math.min(this.models.length-1,e+t);return[e,i]}},{key:"renderItemsRange",value:function(e){var i=this,o=f(e,2),n=o[0],r=o[1];this.__actualIndex__=n;var s=Math.max(0,n-this.visibleOutboundItemsCount),l=Math.min(this.models.length-1,r+this.visibleOutboundItemsCount),a=this.models.slice(s,l),h=a.map(function(e,t){var o=i.getView(e,s+Number(t));return o.el.setAttribute("data-index",o.indexInModelList),o});this.renderViews(h),t.DEV_MODE&&this.renderDebugInfos()}},{key:"renderVisibleItems",value:function(){this.renderItemsRange(this.defineRangeOfModelsVisibles())}},{key:"renderViews",value:function(e){var t=this.$listContainer.children().toArray().map(function(e){return e.__view__});if(0===t.length)this.addViews(e);else{var i=_.reject(t,function(t){return e.includes(t)}),o=e;this.removeViews(i),this.addViews(o)}}},{key:"getView",value:function(e,t){var i=this.viewsMap.get(e[this.idModelPropertyName]);if("undefined"==typeof this.idModelPropertyName)throw new Error("BufferedListView#idModelPropertyName must be defined");if("undefined"==typeof e[this.idModelPropertyName])throw new Error("The model."+this.idModelPropertyName+" is undefined. There is no chance to show more than one view.");if(!i){if(i=this.viewsPool.borrows(),!i)throw new Error("No views availables. Actually borrowed: "+this.viewsPool.getCountBorrowed());i.model=e,i.indexInModelList=t,i.render(),this.viewsMap.set(e[this.idModelPropertyName],i)}return i}},{key:"removeViews",value:function(e){for(var t=0;t<e.length;t++)this.removeView(e[t])}},{key:"removeView",value:function(e){this.viewsMap["delete"](e.model[this.idModelPropertyName]),this.viewsPool.returns(e)}},{key:"addViews",value:function(e){for(var t=0;t<e.length;t++)this.addView(e[t],t)}},{key:"addView",value:function(e,t){var i=this.$listContainer,o=i.children(),n=this.listItemHeight*e.indexInModelList;e.el.style.top=String(n)+"px",o.length<=t?i.append(e.el):0===t?i.prepend(e.el):(0,h["default"])(i.children().get(t)).after(e.el)}},{key:"onResize",value:function(e){this._onResize(e),this.renderVisibleItems()}},{key:"onScroll",value:function(e){this._onScroll(e)}},{key:"_onResize",value:function(e){this.listHeightAutoMode&&(this.listHeight=this.queryListHeight())}},{key:"_onScroll",value:function(e){this.scrollPositionY=this.$scrollerContainer.scrollTop(),this.renderVisibleItems()}},{key:"renderDebugInfos",value:function(){var e=this.defineRangeOfModelsVisibles(),t=f(e,2),i=t[0],o=t[1];(0,h["default"])("#debug-container").html("\n<div>Actual pool usage: "+this.viewsPool.getCountBorrowed()+" / "+this.viewsPool.getCountAvailables()+"</div>\n<div>Visible range: ("+i+", "+o+")</div>\n<div>Visible models: ("+Math.max(0,i-this.visibleOutboundItemsCount)+", "+Math.min(this.models.length-1,o+this.visibleOutboundItemsCount)+")\n<div>Current start index: "+this.__actualIndex__+"</div>")}}]),t}(u["default"].View);e["default"]=b});